<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Core__Local_env (ppx_pbt.Core__Local_env)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ppx_pbt</a> &#x00BB; Core__Local_env</nav><h1>Module <code>Core__Local_env</code></h1><p>Module handling the local environment of a file.</p><p>Pre-processing is applied in the first place on the interface file. That first step collect information on functions where there is a pbt specification attached to a signature_item. These information are storred in <code>t</code>, they later can be stored on the disk and restored when the pre-processing is applied on the implementation file</p></header><dl><dt class="spec type" id="type-md_expr"><a href="#type-md_expr" class="anchor"></a><code><span class="keyword">type</span> md_expr</code> = <code>[ </code><table class="variant"><tr id="type-md_expr.Structure" class="anchored"><td class="def constructor"><a href="#type-md_expr.Structure" class="anchor"></a><code>| </code><code>`Structure</code></td></tr><tr id="type-md_expr.Functor" class="anchored"><td class="def constructor"><a href="#type-md_expr.Functor" class="anchor"></a><code>| </code><code>`Functor</code></td></tr></table><code> ]</code></dt><dt class="spec type" id="type-path"><a href="#type-path" class="anchor"></a><code><span class="keyword">type</span> path</code><code> = <span><span>[ <span>`Psig_module of string</span> <span>| <a href="index.html#type-md_expr">md_expr</a></span> ]</span> list</span></code></dt><dd><p><code>path</code> is a DFS representation of recursive signature item</p></dd></dl><dl><dt class="spec type" id="type-psig_value"><a href="#type-psig_value" class="anchor"></a><code><span class="keyword">type</span> psig_value</code></dt><dd><p><code>psig_value</code> stores the function with the associated specification found in the attributes.</p><p>The <a href="index.html#type-path"><code>path</code></a> and actual signature_item is stored inside <code>psig_value</code> in order to be retrived in the respective structure_item</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><dl><dt class="spec value" id="val-get_path"><a href="#val-get_path" class="anchor"></a><code><span class="keyword">val</span> get_path : <a href="index.html#type-psig_value">psig_value</a> <span>&#45;&gt;</span> <a href="index.html#type-path">path</a></code></dt><dd><p><code>get_path psig_value</code> returns the path inside <code>psig_value</code></p></dd></dl><dl><dt class="spec value" id="val-get_properties"><a href="#val-get_properties" class="anchor"></a><code><span class="keyword">val</span> get_properties : <a href="index.html#type-psig_value">psig_value</a> <span>&#45;&gt;</span> <a href="../Core/Properties/index.html#type-t">Core.Properties.t</a></code></dt><dd><p><code>get_properties psig_value</code> returns the properties inside <code>psig_value</code></p></dd></dl><dl><dt class="spec value" id="val-get_name"><a href="#val-get_name" class="anchor"></a><code><span class="keyword">val</span> get_name : <a href="index.html#type-psig_value">psig_value</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>get_name psig_value</code> returns the function name inside <code>psig_value</code></p></dd></dl><dl><dt class="spec value" id="val-get_value"><a href="#val-get_value" class="anchor"></a><code><span class="keyword">val</span> get_value : <a href="index.html#type-psig_value">psig_value</a> <span>&#45;&gt;</span> <span>Ppxlib.signature_item option</span></code></dt><dd><p><code>get_value psig_value</code> returns the actual value inside <code>psig_value</code></p></dd></dl><dl><dt class="spec value" id="val-get_file_name"><a href="#val-get_file_name" class="anchor"></a><code><span class="keyword">val</span> get_file_name : unit <span>&#45;&gt;</span> string</code></dt><dd><p><code>get_file_name ()</code> returns the file_name inside the environment <code>t</code></p><p>Default value is &quot;_none_&quot; if the file_name has not been set</p></dd></dl><dl><dt class="spec value" id="val-get_file_name_exn"><a href="#val-get_file_name_exn" class="anchor"></a><code><span class="keyword">val</span> get_file_name_exn : unit <span>&#45;&gt;</span> string</code></dt><dd><p><code>get_file_name_exn ()</code> returns the file_name inside the environment <code>t</code></p><p>Raise an exception if the file_name has not been set</p></dd></dl><dl><dt class="spec value" id="val-get_file_name_opt"><a href="#val-get_file_name_opt" class="anchor"></a><code><span class="keyword">val</span> get_file_name_opt : unit <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>get_file_name_opt ()</code> returns the file_name inside the environment <code>t</code></p><p>Returns None if the file_name has not been set</p></dd></dl><dl><dt class="spec value" id="val-get_psig_values"><a href="#val-get_psig_values" class="anchor"></a><code><span class="keyword">val</span> get_psig_values : unit <span>&#45;&gt;</span> <span><a href="index.html#type-psig_value">psig_value</a> list</span></code></dt><dd><p><code>get_psig_values ()</code> returns the list of psig_value in the environment <code>t</code></p></dd></dl><dl><dt class="spec value" id="val-env_with_psig_value"><a href="#val-env_with_psig_value" class="anchor"></a><code><span class="keyword">val</span> env_with_psig_value : <a href="index.html#type-psig_value">psig_value</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>env_with_psig_value psig_value</code> add <code>psig_value</code> to the environment <code>t</code></p></dd></dl><dl><dt class="spec value" id="val-env_with_file_name"><a href="#val-env_with_file_name" class="anchor"></a><code><span class="keyword">val</span> env_with_file_name : string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>env_with_file_name file_name</code> set the file_name in the environment <code>t</code></p></dd></dl><dl><dt class="spec value" id="val-add_env"><a href="#val-add_env" class="anchor"></a><code><span class="keyword">val</span> add_env : <span>?&#8288;path:<a href="index.html#type-path">path</a></span> <span>&#45;&gt;</span> <span>?&#8288;properties:<a href="../Core/Properties/index.html#type-t">Core.Properties.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;value:Ppxlib.signature_item</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_env name</code> build and add a psig_value in the environment <code>t</code></p></dd></dl><dl><dt class="spec value" id="val-init_env"><a href="#val-init_env" class="anchor"></a><code><span class="keyword">val</span> init_env : <span>?&#8288;file_name:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>init_env</code> reset the environment to default state, file_name being processed can be set at this point with the parameter <code>file_name</code></p></dd></dl><dl><dt class="spec value" id="val-store_env"><a href="#val-store_env" class="anchor"></a><code><span class="keyword">val</span> store_env : unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>store_env</code> store on disk the environment <code>t</code></p></dd></dl><dl><dt class="spec value" id="val-fetch_env"><a href="#val-fetch_env" class="anchor"></a><code><span class="keyword">val</span> fetch_env : string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>fetch_env file_path</code> restore the environment <code>t</code> from the disk using <code>file_name</code> to fetch the correct environment</p></dd></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : Stdlib.Format.formatter <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp ()</code> pretty print the current environment, exposed only for internal testing</p></dd></dl></div></body></html>